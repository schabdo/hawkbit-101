{
	"info": {
		"_postman_id": "08ab393e-90ac-8aaf-8a45-2ef997713e4f",
		"name": "EclipseCon 2019 - hawkBit101 Tutorial",
		"description": "This Postman collection is part of the hawkBit 101 Tutorial which was developed for EclipseCon 2019.\n\nIts purpose is to demonstrate the public APIs of Eclipse hawkBit, in particular the\n- Direct Device Integration API (DDI) and\n- Management REST API.\n\nThere is a separate folder for each part of the tutorial. Each folder contains a couple of requests which are meant to be executed in sequential order.\n\nIt is recommended to execute this collection against the hawkBit Docker setup which is available here:\nhttps://github.com/stefbehl/hawkbit-101\n",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Setup Verification",
			"item": [
				{
					"name": "Step 1: Verify Update Server is Running",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "185fc87d-f084-43f0-95e7-a3922f30e636",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/UI/login",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"UI",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2: Verify Device Simulator is Running",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "f2aa7b30-100e-471d-b283-917872d59579",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{deviceSimulatorPort}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{deviceSimulatorPort}}"
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "544da37d-587e-42ef-bbe9-db8fcdbf797f",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "abf5119a-3829-4df4-a3e5-e038ebd2b6fd",
						"type": "text/javascript",
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"pm.test(\"Status is UP\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.status).to.eql(\"UP\");",
							"});"
						]
					}
				}
			]
		},
		{
			"name": "Part 1: Provisioning a Device (Mgmt API + DDI)",
			"item": [
				{
					"name": "Step 1: Enable Target Token Authentication (Mgmt API)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "a8932cdb-1cd3-4b72-8008-cf320834122c",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"value\": true\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/system/configs/authentication.targettoken.enabled/",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"system",
								"configs",
								"authentication.targettoken.enabled",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2: Device Pre-Provisioning (Mgmt API)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "e37b4498-c74a-4630-870f-715396b5aed9",
								"exec": [
									"verifyStatusCode(pm, 201);",
									"",
									"var target = JSON.parse(responseBody)[0];",
									"saveVariable(pm, \"currentTargetToken\", target.securityToken);",
									"saveVariable(pm, \"currentTargetId\", target.controllerId);"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "e92b6e1b-963a-482e-a7cb-a691c635dcf7",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "admin",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								},
								{
									"key": "saveHelperData",
									"type": "any"
								},
								{
									"key": "showPassword",
									"value": false,
									"type": "boolean"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\"controllerId\":\"device01\",\"name\":\"Device 01\",\"description\":\"My first device\"}]"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/targets",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"targets"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 3: Device Registration (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "5f0506e4-f9f9-4b36-87c7-bfbf6a39f4da",
								"exec": [
									"restoreVariable(pm, \"currentTargetId\");",
									"restoreVariable(pm, \"currentTargetToken\");",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "ad0e5e63-967e-49c8-91d2-2acf91679360",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "TargetToken {{currentTargetToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\n    \"controllerId\" : \"device01\",\n    \"name\" : \"Device 01\",\n    \"description\" : \"My first device\"\n}]"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/{{tenant}}/controller/v1/{{currentTargetId}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"{{tenant}}",
								"controller",
								"v1",
								"{{currentTargetId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 4: Set Device Attributes (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "225d132a-d1bd-4e6d-9347-0bd0abf80169",
								"exec": [
									"restoreVariable(pm, \"currentTargetId\");",
									"restoreVariable(pm, \"currentTargetToken\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "51f1a81d-84a2-47b7-a9e5-961f75a28b7e",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "TargetToken {{currentTargetToken}}"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"mode\": \"merge\",\n    \"data\": {\n        \"VIN\": \"JH4TB2H26CC000001\",\n        \"hwRevision\": \"1\"\n    },\n    \"status\": {\n        \"result\": {\n            \"finished\": \"success\"\n        },\n        \"execution\": \"closed\",\n        \"details\": []\n    }\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/{{tenant}}/controller/v1/{{currentTargetId}}/configData",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"{{tenant}}",
								"controller",
								"v1",
								"{{currentTargetId}}",
								"configData"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "446c9411-8659-4ff9-829d-ae6a1b37b2bb",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "c7639181-c4ed-4356-a5de-4841a7eeeed1",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Part 2: Creating an Update (Mgmt API)",
			"item": [
				{
					"name": "Step 1: Create a Software Module",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "ea205465-da4e-4eb6-bf3f-c4725e0becbf",
								"exec": [
									"verifyStatusCode(pm, 201);",
									"",
									"saveVariable(pm, \"currentSoftwareModuleId\", JSON.parse(responseBody)[0].id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\n    \"vendor\": \"Example Ltd.\",\n    \"name\": \"os\",\n    \"description\": \"First version of MyOS.\",\n    \"type\": \"os\",\n    \"version\": \"1.0\"\n}]"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/softwaremodules",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"softwaremodules"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2: Upload an Artifact",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "59e2c339-f36b-4338-8ce9-a8496b949b6a",
								"exec": [
									"restoreVariable(pm, \"currentSoftwareModuleId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "fce41a81-b33f-4c28-84ec-02c89612f907",
								"exec": [
									"verifyStatusCode(pm, 201);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"value": ""
								}
							]
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/softwaremodules/{{currentSoftwareModuleId}}/artifacts",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"softwaremodules",
								"{{currentSoftwareModuleId}}",
								"artifacts"
							]
						},
						"description": "This steps requires that you create a file in your home directory first:\n$ echo \"This is a test update file\" > artifact01.file"
					},
					"response": []
				},
				{
					"name": "Step 3: Create a Distribution Set",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "7a87470d-6daa-4568-93b8-f4b36eb12b98",
								"exec": [
									"restoreVariable(pm, \"currentSoftwareModuleId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "251f61dc-07a0-4165-90db-b860fd205588",
								"exec": [
									"verifyStatusCode(pm, 201);",
									"",
									"saveVariable(pm, \"currentDistributionSetId\", JSON.parse(responseBody)[0].id);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\n    \"requiredMigrationStep\": false,\n    \"name\": \"myOs-ds\",\n    \"description\": \"MyOS initial update\",\n    \"type\": \"os\",\n    \"version\": \"1.0\"\n}]"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/distributionsets",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"distributionsets"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 4: Assign the Software Module to the Distribution Set",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "47ba429d-f221-49d1-a007-3081e351a08f",
								"exec": [
									"restoreVariable(pm, \"currentSoftwareModuleId\");",
									"restoreVariable(pm, \"currentDistributionSetId\");",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "9f1fddc1-754c-427c-87e2-7e2e01922e16",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\n    \"id\": {{currentSoftwareModuleId}}\n}]"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/distributionsets/{{currentDistributionSetId}}/assignedSM",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"distributionsets",
								"{{currentDistributionSetId}}",
								"assignedSM"
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "basic",
				"basic": [
					{
						"key": "username",
						"value": "admin",
						"type": "string"
					},
					{
						"key": "password",
						"value": "admin",
						"type": "string"
					},
					{
						"key": "saveHelperData",
						"type": "any"
					},
					{
						"key": "showPassword",
						"value": false,
						"type": "boolean"
					}
				]
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "bd8992b9-bebe-4485-9923-948c449ef289",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "041ebc2d-0c1a-45e9-90b3-4399e157a5c7",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Part 3: Updating a Single Device (Mgmt API + DDI)",
			"item": [
				{
					"name": "Step 1: Assign a Distribution Set to a Device (Mgmt API)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "027bbd61-7b1b-445a-afa4-e5200978720d",
								"exec": [
									"restoreVariable(pm, \"currentTargetId\");",
									"restoreVariable(pm, \"currentDistributionSetId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "bd0c5eec-42b0-419b-8621-0b02d14374b9",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								},
								{
									"key": "password",
									"value": "admin",
									"type": "string"
								},
								{
									"key": "saveHelperData",
									"type": "any"
								},
								{
									"key": "showPassword",
									"value": false,
									"type": "boolean"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[{\n  \"id\" : \"{{currentTargetId}}\",\n  \"type\" : \"forced\"\n}]"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/distributionsets/{{currentDistributionSetId}}/assignedTargets/",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"distributionsets",
								"{{currentDistributionSetId}}",
								"assignedTargets",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2: Poll for Updates (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "5200998d-1002-4ccf-bb20-7dc5f8e1be25",
								"exec": [
									"restoreVariable(pm, \"currentTargetId\");",
									"restoreVariable(pm, \"currentTargetToken\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "f96b02b0-abd3-400d-8f17-a08f4d91c031",
								"exec": [
									"verifyStatusCode(pm, 200);",
									"",
									"console.log(\"Found deployment action \" + JSON.parse(responseBody)._links.deploymentBase.href);",
									"saveVariable(pm, \"currentDeploymentActionHref\",  JSON.parse(responseBody)._links.deploymentBase.href);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "TargetToken {{currentTargetToken}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/DEFAULT/controller/v1/{{currentTargetId}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"DEFAULT",
								"controller",
								"v1",
								"{{currentTargetId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 3: Inspect Update /Deployment Action (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "db30db3c-5f8e-4688-84ea-b735ae62102f",
								"exec": [
									"restoreVariable(pm, \"currentTargetToken\");",
									"restoreVariable(pm, \"currentDeploymentActionHref\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "85e6c2c1-3cdd-4306-b1b6-8dabc0772c2b",
								"exec": [
									"verifyStatusCode(pm, 200);",
									"",
									"var downloadLink = JSON.parse(responseBody).deployment.chunks[0].artifacts[0]._links[\"download-http\"].href;",
									"console.log(\"Found artifact download URL \" + downloadLink);",
									"saveVariable(pm, \"currentArtifactDownloadHref\", downloadLink);",
									"",
									"var actionId = JSON.parse(responseBody).id;",
									"console.log(\"Found deployment action ID \" + actionId);",
									"saveVariable(pm, \"currentDeploymentActionId\", actionId);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "TargetToken {{currentTargetToken}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{currentDeploymentActionHref}}",
							"host": [
								"{{currentDeploymentActionHref}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 4: Download Artifact (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "1d673cb2-ed32-455c-8e6c-92dc9348feb0",
								"exec": [
									"restoreVariable(pm, \"currentTargetToken\");",
									"restoreVariable(pm, \"currentArtifactDownloadHref\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "aba77b24-4214-4e9b-8d4e-616b06493396",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "TargetToken {{currentTargetToken}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{currentArtifactDownloadHref}}",
							"host": [
								"{{currentArtifactDownloadHref}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 5.1: Provide Intermediary Feedback (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "24c54252-63f4-4203-8600-39e0062f5a02",
								"exec": [
									"restoreVariable(pm, \"currentTargetId\");",
									"restoreVariable(pm, \"currentTargetToken\");",
									"restoreVariable(pm, \"currentDeploymentActionId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "f7abd3c9-63f0-494e-a936-7ec372899900",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "TargetToken {{currentTargetToken}}"
							},
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"id\" : \"{{currentDeploymentActionId}}\",\n    \"status\" : {\n        \"result\": {\n            \"progress\": {\n                \"cnt\": 2,\n                \"of\": 5\n            },\n            \"finished\": \"none\"\n        },\n        \"execution\": \"proceeding\",\n        \"details\": [\"The update is being processed.\"]\n    }\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/DEFAULT/controller/v1/{{currentTargetId}}/deploymentBase/{{currentDeploymentActionId}}/feedback",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"DEFAULT",
								"controller",
								"v1",
								"{{currentTargetId}}",
								"deploymentBase",
								"{{currentDeploymentActionId}}",
								"feedback"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 5.2: Provide Deployment Feedback (DDI)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "24c54252-63f4-4203-8600-39e0062f5a02",
								"exec": [
									"restoreVariable(pm, \"currentTargetId\");",
									"restoreVariable(pm, \"currentTargetToken\");",
									"restoreVariable(pm, \"currentDeploymentActionId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "f7abd3c9-63f0-494e-a936-7ec372899900",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "TargetToken {{currentTargetToken}}"
							},
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"id\" : \"{{currentDeploymentActionId}}\",\n    \"status\" : {\n        \"result\" : {\n            \"finished\" : \"success\"\n        },\n        \"execution\" : \"closed\",\n        \"details\" : [\"The update was successfully installed.\"]\n    }\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/DEFAULT/controller/v1/{{currentTargetId}}/deploymentBase/{{currentDeploymentActionId}}/feedback",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"DEFAULT",
								"controller",
								"v1",
								"{{currentTargetId}}",
								"deploymentBase",
								"{{currentDeploymentActionId}}",
								"feedback"
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "406fdc90-2c07-4d88-92f5-6afcec1a4479",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "2f89b688-5734-46d9-bba0-60bc96c4ec07",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "Part 4: Updating Many Devices (Mgmt API)",
			"item": [
				{
					"name": "Step 1.1: Enable Gateway Token Authentication (Mgmt API)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "4fb8dcc3-3217-4433-963c-d52575749d1d",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"value\" : true\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/system/configs/authentication.gatewaytoken.enabled/",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"system",
								"configs",
								"authentication.gatewaytoken.enabled",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 1.2: Initialize Gateway Token (Mgmt API)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "1e879b13-1c5f-4483-ae03-da10ba2bc9fa",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"value\": \"{{gatewayToken}}\"\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/system/configs/authentication.gatewaytoken.key/",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"system",
								"configs",
								"authentication.gatewaytoken.key",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2.1: Provision Many Devices for Group \"EMEA\" (Device Simulator + DDI)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "3970c007-c19e-4360-a9df-8cb13447ea31",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{deviceSimulatorPort}}/start?name=emeadevice&amount=15&tenant=DEFAULT&api=ddi&endpoint=http://hawkbit:{{port}}&gatewaytoken={{gatewayToken}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{deviceSimulatorPort}}",
							"path": [
								"start"
							],
							"query": [
								{
									"key": "name",
									"value": "emeadevice"
								},
								{
									"key": "amount",
									"value": "15"
								},
								{
									"key": "tenant",
									"value": "DEFAULT"
								},
								{
									"key": "api",
									"value": "ddi"
								},
								{
									"key": "endpoint",
									"value": "http://hawkbit:{{port}}"
								},
								{
									"key": "gatewaytoken",
									"value": "{{gatewayToken}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2.2: Provision Many Devices for Group \"APAC\" (Device Simulator + DDI)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "e3424337-2008-4718-8b37-f52d080939bb",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{deviceSimulatorPort}}/start?name=apacdevice&amount=20&tenant=DEFAULT&api=ddi&endpoint=http://hawkbit:{{port}}&gatewaytoken={{gatewayToken}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{deviceSimulatorPort}}",
							"path": [
								"start"
							],
							"query": [
								{
									"key": "name",
									"value": "apacdevice"
								},
								{
									"key": "amount",
									"value": "20"
								},
								{
									"key": "tenant",
									"value": "DEFAULT"
								},
								{
									"key": "api",
									"value": "ddi"
								},
								{
									"key": "endpoint",
									"value": "http://hawkbit:{{port}}"
								},
								{
									"key": "gatewaytoken",
									"value": "{{gatewayToken}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 2.3: Provision Many Devices for Group \"Americas\" (Device Simulator + DDI)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "3e9c5143-6189-4bfe-b461-7b207427431b",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{deviceSimulatorPort}}/start?name=amerdevice&amount=30&tenant=DEFAULT&api=ddi&endpoint=http://hawkbit:{{port}}&gatewaytoken={{gatewayToken}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{deviceSimulatorPort}}",
							"path": [
								"start"
							],
							"query": [
								{
									"key": "name",
									"value": "amerdevice"
								},
								{
									"key": "amount",
									"value": "30"
								},
								{
									"key": "tenant",
									"value": "DEFAULT"
								},
								{
									"key": "api",
									"value": "ddi"
								},
								{
									"key": "endpoint",
									"value": "http://hawkbit:{{port}}"
								},
								{
									"key": "gatewaytoken",
									"value": "{{gatewayToken}}"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 3: Create a Rollout (Mgmt API)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "fb3d7d34-30e8-47da-ab74-8f3e77d46632",
								"exec": [
									"verifyStatusCode(pm, 201);",
									"",
									"var rolloutId = JSON.parse(responseBody).id;",
									"saveVariable(pm, \"currentRolloutId\", rolloutId);"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "a5c1c4a1-669a-4fe2-8ae6-339ac7aa3082",
								"exec": [
									"restoreVariable(pm, \"currentDistributionSetId\");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"distributionSetId\" : {{currentDistributionSetId}},\n    \"targetFilterQuery\" : \"description=='Plug and Play*'\",\n    \"name\" : \"MyOS-Global-Rollout-1.0\",\n    \"description\" : \"Global rollout of MyOS\",\n    \"groups\" : [\n    {\n        \"name\" : \"EMEA_Devices\",\n        \"description\" : \"Devices in EMEA\",\n        \"targetFilterQuery\" : \"name==emea*\",\n        \"successCondition\" : {\n            \"condition\" : \"THRESHOLD\",\n            \"expression\" : \"70\"\n        },\n        \"successAction\" : {\n            \"expression\" : \"\",\n            \"action\" : \"NEXTGROUP\"\n        },\n        \"errorAction\" : {\n            \"expression\" : \"\",\n            \"action\" : \"PAUSE\"\n        },\n        \"errorCondition\" : {\n            \"condition\" : \"THRESHOLD\",\n            \"expression\" : \"20\"\n        }\n    },\n    {\n        \"name\" : \"APAC_Devices\",\n        \"description\" : \"Devices in APAC\",\n        \"targetFilterQuery\" : \"name==apac*\",\n        \"successCondition\" : {\n            \"condition\" : \"THRESHOLD\",\n            \"expression\" : \"50\"\n        },\n        \"successAction\" : {\n            \"expression\" : \"\",\n            \"action\" : \"NEXTGROUP\"\n        },\n        \"errorAction\" : {\n            \"expression\" : \"\",\n            \"action\" : \"PAUSE\"\n        },\n        \"errorCondition\" : {\n            \"condition\" : \"THRESHOLD\",\n            \"expression\" : \"20\"\n        }\n    },\n    {\n        \"name\" : \"AMER_Devices\",\n        \"description\" : \"Devices in AMER\",\n        \"targetFilterQuery\" : \"name==amer*\",\n        \"successCondition\" : {\n            \"condition\" : \"THRESHOLD\",\n            \"expression\" : \"25\"\n        },\n        \"successAction\" : {\n            \"expression\" : \"\",\n            \"action\" : \"NEXTGROUP\"\n        },\n        \"errorAction\" : {\n            \"expression\" : \"\",\n            \"action\" : \"PAUSE\"\n        },\n        \"errorCondition\" : {\n            \"condition\" : \"THRESHOLD\",\n            \"expression\" : \"20\"\n        }\n    }]\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/rollouts",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"rollouts"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 4: Start the Rollout (Mgmt API)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "cdfdc885-00b6-4442-8ee1-d65473bff47a",
								"exec": [
									"restoreVariable(pm, \"currentRolloutId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "43231d52-0e86-48a2-b53c-dfe01826f942",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/rollouts/{{currentRolloutId}}/start",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"rollouts",
								"{{currentRolloutId}}",
								"start"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 5: Create a Target Filter for \"EMEA\" (Mgmt API)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "0d028b1c-9849-400d-b2be-2c47cba37282",
								"exec": [
									"verifyStatusCode(pm, 201);",
									"",
									"var filterId = JSON.parse(responseBody).id;",
									"if (filterId) {",
									"    saveVariable(pm, \"currentTargetFilterId\", filterId);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n   \"query\" : \"name==emeadevice*\",\n   \"name\" : \"EMEA_Devices\"\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/targetfilters",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"targetfilters"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 6: Set Auto Assignment Distribution Set (Mgmt API)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "27b435f9-3fd6-4390-a7c6-9ffc3a00a052",
								"exec": [
									"restoreVariable(pm, \"currentDistributionSetId\");",
									"restoreVariable(pm, \"currentTargetFilterId\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "bf88cdb3-340e-4d7d-9489-3ae88992299e",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n\t\"id\": \"{{currentDistributionSetId}}\"\n}"
						},
						"url": {
							"raw": "{{baseURL}}:{{port}}/rest/v1/targetfilters/{{currentTargetFilterId}}/autoAssignDS",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{port}}",
							"path": [
								"rest",
								"v1",
								"targetfilters",
								"{{currentTargetFilterId}}",
								"autoAssignDS"
							]
						}
					},
					"response": []
				},
				{
					"name": "Step 7: Provision some more Devices for Group \"EMEA\" (Device Simulator + DDI)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "ffcfa180-9efc-429a-9bd6-e8b47b28eb45",
								"exec": [
									"verifyStatusCode(pm, 200);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseURL}}:{{deviceSimulatorPort}}/start?name=emeadevice&amount=30&tenant=DEFAULT&api=ddi&endpoint=http://hawkbit:{{port}}&gatewaytoken={{gatewayToken}}",
							"host": [
								"{{baseURL}}"
							],
							"port": "{{deviceSimulatorPort}}",
							"path": [
								"start"
							],
							"query": [
								{
									"key": "name",
									"value": "emeadevice"
								},
								{
									"key": "amount",
									"value": "30"
								},
								{
									"key": "tenant",
									"value": "DEFAULT"
								},
								{
									"key": "api",
									"value": "ddi"
								},
								{
									"key": "endpoint",
									"value": "http://hawkbit:{{port}}"
								},
								{
									"key": "gatewaytoken",
									"value": "{{gatewayToken}}"
								}
							]
						}
					},
					"response": []
				}
			],
			"auth": {
				"type": "basic",
				"basic": [
					{
						"key": "username",
						"value": "admin",
						"type": "string"
					},
					{
						"key": "password",
						"value": "admin",
						"type": "string"
					},
					{
						"key": "saveHelperData",
						"type": "any"
					},
					{
						"key": "showPassword",
						"value": false,
						"type": "boolean"
					}
				]
			},
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "c1e362cf-d3ff-4a87-b6f8-01c73d9eb6ff",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "af283eb2-a7b1-4a8a-9af6-678986fedb90",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			]
		}
	],
	"auth": {
		"type": "basic",
		"basic": [
			{
				"key": "username",
				"value": "admin",
				"type": "string"
			},
			{
				"key": "password",
				"value": "admin",
				"type": "string"
			},
			{
				"key": "saveHelperData",
				"type": "any"
			},
			{
				"key": "showPassword",
				"value": false,
				"type": "boolean"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "6d35e598-cd67-49b1-a8c6-8e548f242f29",
				"type": "text/javascript",
				"exec": [
					"saveVariable = function(session, key, value) {",
					"    session.globals.set(key, value);",
					"}",
					"",
					"restoreVariable = function(session, key) {",
					"    var value = session.globals.get(key);",
					"    if (value) {",
					"        session.variables.set(key, value);",
					"    } else {",
					"        console.log(\"Could not find \" + key);",
					"    }",
					"}",
					"",
					"verifyStatusCode = function(session, statusCode) {",
					"    session.test(\"Status code is \" + statusCode, function () {",
					"        session.response.to.have.status(statusCode);",
					"    });",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "ff45bd36-62df-4a00-b13b-324d3dc50afb",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "7e8b64a3-be6f-4eba-b1b7-c3b6c0c09e8b",
			"key": "baseURL",
			"value": "http://localhost",
			"type": "string"
		},
		{
			"id": "5fe68fd6-bb0b-4d89-b6a4-f0a98571690c",
			"key": "port",
			"value": "8080",
			"type": "string"
		},
		{
			"id": "c115ea1c-fed1-4fd2-acf1-a7c8d9f9e22d",
			"key": "deviceSimulatorPort",
			"value": "8083",
			"type": "string"
		},
		{
			"id": "848ff24d-fe61-4c97-b6ba-0d4482c996a4",
			"key": "tenant",
			"value": "DEFAULT",
			"type": "string"
		},
		{
			"id": "4654134d-9bec-4ca9-b432-e99e9227021b",
			"key": "gatewayToken",
			"value": "e61c6b2b78a674d19304c357a20f1d09",
			"type": "string"
		},
		{
			"id": "5e49abc8-8b29-4dd0-a19a-2d93535fb432",
			"key": "currentTargetToken",
			"value": "",
			"type": "string"
		},
		{
			"id": "f03853f7-3969-4a3e-8c4c-14f64b5ec248",
			"key": "currentSoftwareModuleId",
			"value": "",
			"type": "string"
		},
		{
			"id": "c9b6b4b3-4218-48df-9dc6-8858781412a3",
			"key": "currentDistributionSetId",
			"value": "",
			"type": "string"
		},
		{
			"id": "ae921dc3-02c5-46a8-b345-7c3285264508",
			"key": "currentTargetId",
			"value": "",
			"type": "string"
		},
		{
			"id": "39b86b11-5617-49dd-b057-7aef9deca170",
			"key": "currentDeploymentActionHref",
			"value": "",
			"type": "string"
		},
		{
			"id": "0b180516-4b7a-422b-9167-88e5dc7cba07",
			"key": "currentArtifactDownloadHref",
			"value": "",
			"type": "string"
		},
		{
			"id": "caae5b3a-6c4b-4266-b6be-a336d4476f56",
			"key": "currentDeploymentActionId",
			"value": "",
			"type": "string"
		},
		{
			"id": "2810cd04-9b82-48eb-83c1-d22e62f1e551",
			"key": "currentRolloutId",
			"value": "",
			"type": "string"
		},
		{
			"id": "5dd6fded-dadc-4a1c-96f9-a2d32adb22e0",
			"key": "currentTargetFilterId",
			"value": "",
			"type": "string"
		}
	]
}